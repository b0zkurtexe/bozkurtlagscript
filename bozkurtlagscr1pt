local Players = game:GetService("Players")
local player = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local guiCreated = false -- GUI'nin bir kez oluşturulduğunu kontrol eder
local mainScreenGui

local function createGUI()
    if guiCreated then return end
    guiCreated = true

    mainScreenGui = Instance.new("ScreenGui")
    mainScreenGui.Name = "Bozkurtqww"
    mainScreenGui.Parent = game.CoreGui

    -- Sahte Lag Button
    local FakeLagButton = Instance.new("TextButton")
    FakeLagButton.Parent = mainScreenGui
    FakeLagButton.BackgroundColor3 = Color3.new(0,0,0)
    FakeLagButton.Size = UDim2.new(0, 135, 0, 50)
    FakeLagButton.Position = UDim2.new(0.5, 200, 0.5, -50)
    FakeLagButton.Text = "Bozkurtqww Lag Scr1pt"
    FakeLagButton.TextColor3 = Color3.new(1,1,1)
    FakeLagButton.BorderSizePixel = 0
    FakeLagButton.Font = Enum.Font.SourceSans
    FakeLagButton.TextSize = 18
    FakeLagButton.AutoButtonColor = false

    local UICorner1 = Instance.new("UICorner")
    UICorner1.CornerRadius = UDim.new(0, 10)
    UICorner1.Parent = FakeLagButton

    local dragging = false
    local dragInput
    local dragStart
    local startPos
    local FakeLag = false

    local function update(input)
        local delta = input.Position - dragStart
        FakeLagButton.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end

    FakeLagButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = FakeLagButton.Position

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)

    FakeLagButton.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if dragging and input == dragInput then
            update(input)
        end
    end)

    FakeLagButton.MouseButton1Click:Connect(function()
        FakeLag = not FakeLag
        if FakeLag then
            FakeLagButton.Text = "Sahte Lag: Aktif"
        else
            FakeLagButton.Text = "Sahte Lag: Kapalı"
        end
    end)

    coroutine.wrap(function()
        while wait(0.05) do
            if FakeLag then
                local character = player.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    character.HumanoidRootPart.Anchored = true
                    wait(0.4)
                    character.HumanoidRootPart.Anchored = false
                end
            end
        end
    end)()

    -- Düşme Button
    local FallButton = Instance.new("TextButton")
    FallButton.Parent = mainScreenGui
    FallButton.BackgroundColor3 = Color3.new(0,0,0)
    FallButton.Size = UDim2.new(0, 100, 0, 50)
    FallButton.Position = UDim2.new(0.5, 200, 0.5, 0)
    FallButton.Text = "Düşme"
    FallButton.TextColor3 = Color3.new(1,1,1)
    FallButton.BorderSizePixel = 0
    FallButton.Font = Enum.Font.SourceSans
    FallButton.TextSize = 24
    FallButton.AutoButtonColor = false

    local UICorner2 = Instance.new("UICorner")
    UICorner2.CornerRadius = UDim.new(0, 10)
    UICorner2.Parent = FallButton

    local draggingFall = false
    local dragInputFall
    local dragStartFall
    local startPosFall
    local holdStart = 0
    local isPlatformStand = false
    local canStandUp = false

    local function updateFall(input)
        local delta = input.Position - dragStartFall
        FallButton.Position = UDim2.new(startPosFall.X.Scale, startPosFall.X.Offset + delta.X, startPosFall.Y.Scale, startPosFall.Y.Offset + delta.Y)
    end

    FallButton.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            draggingFall = true
            dragStartFall = input.Position
            startPosFall = FallButton.Position
            holdStart = tick()

            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    draggingFall = false
                end
            end)
        end
    end)

    FallButton.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInputFall = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if draggingFall and input == dragInputFall then
            updateFall(input)
        end
    end)

    RunService.RenderStepped:Connect(function()
        if draggingFall and (tick() - holdStart) >= 5 then
            FallButton.Visible = false
        end
    end)

    FallButton.MouseButton1Click:Connect(function()
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            local humanoid = player.Character.Humanoid
            if not isPlatformStand then
                humanoid.PlatformStand = true
                humanoid:Move(Vector3.new(0, -50, 0))
                canStandUp = true
                isPlatformStand = true
            elseif canStandUp then
                humanoid.PlatformStand = false
                isPlatformStand = false
                canStandUp = false
            end
        end
    end)
end

-- Karakter yeniden doğduğunda GUI’yi tekrar oluşturma, sadece mevcut GUI’yi kullan
player.CharacterAdded:Connect(function()
    if mainScreenGui and mainScreenGui.Parent == nil then
        mainScreenGui.Parent = game.CoreGui
    end
end)

-- Başlangıçta GUI’yi oluştur
createGUI()
